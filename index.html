<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>thesaurus</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://unpkg.com/vis-network@9.1.2/standalone/umd/vis-network.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        .top-menu {
            background-color: yellow;
            padding: 12px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            border-radius: 20px;
        }
        .marquee {
            white-space: nowrap;
            overflow: hidden;
            display: block;
            font-size: 16px;
            color: black;
        }
        .marquee span {
            display: inline-block;
            padding-left: 100%;
            animation: marquee 10s linear infinite;
        }
        @keyframes marquee {
            from { transform: translateX(0%); }
            to { transform: translateX(-100%); }
        }
        .main-container {
            display: flex;
            gap: 10px;
        }
        .left-panel {
            width: 80%;
        }
        .right-panel {
            width: 20%;
            border-left: 2px solid #ddd;
            padding-left: 20px;
        }
        #visualization {
            height: 500px;
            background-color: #f8f9fa;
            border: 2px solid #030303;
        }
        #loadingIndicator {
            display: none;
            font-size: 18px;
            color: blue;
            margin-top: 10px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .spinner {
            border: 4px solid rgba(0, 0, 255, 0.3);
            border-top: 4px solid blue;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
    </style>
</head>
<body>
    <div class="top-menu">
        <div class="marquee">
            <span>üèÅ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ –Ω–∞—à —Å–∞–π—Ç —Ç–µ–∑–∞—É—Ä—É—Å–∞! –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –Ω–æ–≤–æ—Å—Ç–∏ –∑–¥–µ—Å—å!</span>
        </div>
    </div>  
    <div class="container text-center mt-5" id="checkServerSection">
        <h1>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏ —Å —Å–µ—Ä–≤–µ—Ä–æ–º</h1>
        <div id="loadingIndicator" class="spinner mx-auto mt-2" style="display: none;"></div>
        <button id="checkServerBtn" class="btn btn-primary mt-3">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
        <p id="serverStatus" class="mt-3"></p>
    </div>
    <div class="container mt-5" id="neo4jSection" style="display: none;">
        <div class="main-container">
            <div class="left-panel">
                <h2>–î–∞–Ω–Ω—ã–µ –≤ –ë–î Neo4j</h2>

                <hr>
                
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div>
                        <div class="btn-group">
                            <button id="loadDataBtn" class="btn btn-info me-2">–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
                        </div>

                        <div class="btn-group">
                            <button id="addOptionBtn" class="btn btn-success dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">–î–æ–±–∞–≤–∏—Ç—å</button>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item add-option" href="#" data-add-type="class">–ö–ª–∞—Å—Å</a></li>
                                <li><a class="dropdown-item add-option" href="#" data-add-type="subclass">–ü–æ–¥–∫–ª–∞—Å—Å</a></li>
                                <li><a class="dropdown-item add-option" href="#" data-add-type="term">–¢–µ—Ä–º–∏–Ω</a></li>
                            </ul>
                        </div>

                        <div class="btn-group">
                            <button id="createRelationBtn" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">–°–æ–∑–¥–∞—Ç—å –æ—Ç–Ω–æ—à–µ–Ω–∏–µ</button>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item relation-option" href="#" data-relation-type="NT">NT</a></li>
                                <li><a class="dropdown-item relation-option" href="#" data-relation-type="RT">RT</a></li>
                                <li><a class="dropdown-item relation-option" href="#" data-relation-type="BT">BT</a></li>      
                                <li><hr class="dropdown-divider"></li>  
                                <li><a class="dropdown-item relation-option" href="#" data-relation-type="UF-1">UF-1</a></li>
                                <li><a class="dropdown-item relation-option" href="#" data-relation-type="UF-2">UF-2</a></li>
                            </ul>
                        </div>
                      
                        <div class="btn-group">
                            <button id="deleteOptionBtn" class="btn btn-danger dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">–£–¥–∞–ª–∏—Ç—å</button>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item delete-option" href="#" data-delete-type="class">–ö–ª–∞—Å—Å</a></li>
                                <li><a class="dropdown-item delete-option" href="#" data-delete-type="subclass">–ü–æ–¥–∫–ª–∞—Å—Å</a></li>
                                <li><a class="dropdown-item delete-option" href="#" data-delete-type="term">–¢–µ—Ä–º–∏–Ω</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item delete-option text-danger" href="#" data-delete-type="clear-all">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ</a></li>
                            </ul>
                        </div>
                        
                        <hr>
                        
                        <h5>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</h5>
                        <div id="visualization"></div>
                    </div>
                </div>
        
            </div>
    
            <div class="right-panel">
                <h2>–õ–æ–≥–∏</h2>
            </div>

        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–Ω–æ—à–µ–Ω–∏—è -->
    <div class="modal fade" id="relationModal" tabindex="-1" aria-labelledby="relationModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="relationModalLabel"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <!-- —Ç–µ–ª–æ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ -->
                <div class="modal-body"></div>
                <!-- –Ω–∏–∂–Ω–∏ –∫–æ–ª–æ–Ω—Ç–∏—Ç—É–ª (–∫–Ω–æ–ø–∫–∏) -->
                <div class="modal-footer"></div>
            </div>  
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —è–∑—ã–∫–æ–≤ -->
    <div class="modal fade" id="confirmationModal" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalLabel">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="modalForm">
                        <div class="mb-3">
                            <label id="modalLabelRu" class="form-label"></label>
                            <input type="text" id="modalInputRu" class="form-control" readonly>
                        </div>
                        <div class="mb-3">
                            <label id="modalLabelKz" class="form-label"></label>
                            <input type="text" id="modalInputKz" class="form-control">
                        </div>
                        <div class="mb-3">
                            <label id="modalLabelEn" class="form-label"></label>
                            <input type="text" id="modalInputEn" class="form-control">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
                    <button type="button" class="btn btn-primary" id="saveModalBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </div>
        </div>
    </div>


    <script>
        
        // –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º –∫–ª–∞—Å—Å—ã
        $(document).on("click", ".relation-option", function (event) {
            event.preventDefault();
            
            const relationType = $(this).data("relation-type");
            console.log("–ù–∞–∂–∞—Ç–∏–µ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ —Å —Ç–∏–ø–æ–º:", relationType);
            
            if (relationType === "UF-1" || relationType === "UF-2") {
                // –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–∏–Ω–æ–Ω–∏–º–∞
                $('#relationModal').modal('show');
                $('#relationModalLabel').text(`–î–æ–±–∞–≤–∏—Ç—å —Å–∏–Ω–æ–Ω–∏–º (${relationType})`);
                $('#relationModal .modal-body').html(`
                    <h6>–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å</h6>
                    <select id="ufClassSelect" class="form-select mb-2"></select>
                    <h6>–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥–∫–ª–∞—Å—Å</h6>
                    <select id="ufSubclassSelect" class="form-select mb-2"></select>
                    <h6>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ—Ä–º–∏–Ω</h6>
                    <select id="ufTermSelect" class="form-select mb-2"></select>
                    <hr>
                    <h6>–°–∏–Ω–æ–Ω–∏–º (–Ω–∞ —Ä—É—Å—Å–∫–æ–º)</h6>
                    <input type="text" id="ufSynonymRu" class="form-control mb-2" placeholder="–°–∏–Ω–æ–Ω–∏–º –Ω–∞ —Ä—É—Å—Å–∫–æ–º">
                    <h6>–°–∏–Ω–æ–Ω–∏–º (–Ω–∞ –∫–∞–∑–∞—Ö—Å–∫–æ–º, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</h6>
                    <input type="text" id="ufSynonymKz" class="form-control mb-2" placeholder="–°–∏–Ω–æ–Ω–∏–º –Ω–∞ –∫–∞–∑–∞—Ö—Å–∫–æ–º">
                    <h6>–°–∏–Ω–æ–Ω–∏–º (–Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</h6>
                    <input type="text" id="ufSynonymEn" class="form-control mb-2" placeholder="–°–∏–Ω–æ–Ω–∏–º –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º">
                `);
                $('#relationModal .modal-footer').html(`
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
                    <button type="button" class="btn btn-primary" id="saveUfSynonymBtn" data-uf-type="${relationType}">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                `);

                // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–ª–∞—Å—Å–æ–≤
                loadClassesModule("ufClassSelect");

                // –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –∫–ª–∞—Å—Å–∞ ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–¥–∫–ª–∞—Å—Å—ã
                $(document).off("change", "#ufClassSelect").on("change", "#ufClassSelect", function () {
                    const selectedClass = $(this).val();
                    loadSubClassesModule(selectedClass, "ufSubclassSelect");
                });

                // –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –ø–æ–¥–∫–ª–∞—Å—Å–∞ ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ—Ä–º–∏–Ω—ã
                $(document).off("change", "#ufSubclassSelect").on("change", "#ufSubclassSelect", function () {
                    const selectedSubclass = $(this).val();
                    loadTermsModule(selectedSubclass, "ufTermSelect");
                });
            }else{
                $('#relationModal').modal('show');
                $('relationModal .modal-body').html("");
                $('#relationModal .modal-footer').html("");
                $('#relationModalLabel').text("–°–æ–∑–¥–∞—Ç—å –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –º–µ–∂–¥—É —Ç–µ—Ä–º–∏–Ω–∞–º–∏");
                

                $('#relationTypeText').text(relationType);
                $('#relationModal .modal-body').append(`
                    <p id="relationTypeText">${relationType}</p>
                    <h6>–¢–µ—Ä–º–∏–Ω 1</h6>
                    <select id="classSelect1" class="form-select mb-2"></select>
                    <select id="subclassSelect1" class="form-select mb-2"></select>
                    <select id="termSelect1" class="form-select mb-2"></select>
                    <h6>–¢–µ—Ä–º–∏–Ω 2</h6>
                    <select id="classSelect2" class="form-select mb-2"></select>
                    <select id="subclassSelect2" class="form-select mb-2"></select>
                    <select id="termSelect2" class="form-select mb-2"></select>
                `);
                
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–ª–∞—Å—Å—ã –¥–ª—è –æ–±–µ–∏—Ö –∫–æ–ª–æ–Ω–æ–∫
                loadClassesModule("classSelect1");
                loadClassesModule("classSelect2");

                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–¥–∫–ª–∞—Å—Å–æ–≤ –∏ —Ç–µ—Ä–º–∏–Ω–æ–≤
                $("#classSelect1").change(function () {
                    const selectedClass = $(this).val();
                    loadSubClassesModule(selectedClass, "subclassSelect1");
                });

                $("#classSelect2").change(function () {
                    const selectedClass = $(this).val();
                    loadSubClassesModule(selectedClass, "subclassSelect2");
                });

                $("#subclassSelect1").change(function () {
                    const selectedSubclass = $(this).val();
                    loadTermsModule(selectedSubclass, "termSelect1");
                });

                $("#subclassSelect2").change(function () {
                    const selectedSubclass = $(this).val();
                    loadTermsModule(selectedSubclass, "termSelect2");
                });

                let selectedTerm1 = null;
                let selectedTerm2 = null;
                $('#termSelect1').change(function () {
                    selectedTerm1 = $(this).val();
                });

                $('#termSelect2').change(function () {
                    selectedTerm2 = $(this).val();
                });


                // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" –≤ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
                $('#relationModal .modal-footer').html(`
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
                    <button type="button" class="btn btn-primary" id="saveRelationBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                `);
                
                // –ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–Ω–æ–ø–∫—É "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
                $("#saveRelationBtn").click(function() {
                    if (selectedTerm1 && selectedTerm2) {
                        const relationType = $('#relationTypeText').text();
                        createRelationBetweenTerms(selectedTerm1, selectedTerm2, relationType);
                        loadGraph();
                    } else {
                        console.log("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –æ–±–∞ —Ç–µ—Ä–º–∏–Ω–∞ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º.");
                    }
                });
            }
        });

        // –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —É–¥–∞–ª–µ–Ω–∏—è
        // –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –æ–ø—Ü–∏—é —É–¥–∞–ª–µ–Ω–∏—è
        $(document).on("click", ".delete-option", function (event) {
            event.preventDefault();

            const deleteType = $(this).data("delete-type");
            console.log("–í—ã–±—Ä–∞–Ω–æ —É–¥–∞–ª–µ–Ω–∏–µ:", deleteType);   

            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            $('#relationModal').modal('show');

            // –û—á–∏—â–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            $('#relationModal .modal-body').html("");
            $('#relationModal .modal-footer').html("");

            if (deleteType === "class") {
                // –£–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞
                $('#relationModalLabel').text("–£–¥–∞–ª–∏—Ç—å –ö–ª–∞—Å—Å");
                $('#relationModal .modal-body').append(`
                    <h6>–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å</h6>
                    <select id="deleteClassSelect" class="form-select mb-2"></select>
                `);

                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–ª–∞—Å—Å—ã
                loadClassesModule("deleteClassSelect");
            } else if (deleteType === "subclass") {
                // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª–∞—Å—Å–∞
                $('#relationModalLabel').text("–£–¥–∞–ª–∏—Ç—å –ü–æ–¥–∫–ª–∞—Å—Å");
                $('#relationModal .modal-body').append(`
                    <h6>–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å</h6>
                    <select id="deleteClassSelect" class="form-select mb-2"></select>
                    <h6>–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥–∫–ª–∞—Å—Å</h6>
                    <select id="deleteSubclassSelect" class="form-select mb-2"></select>
                `);

                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–ª–∞—Å—Å—ã
                loadClassesModule("deleteClassSelect");

                // –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–ª–∞—Å—Å–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–¥–∫–ª–∞—Å—Å—ã
                $(document).on("change", "#deleteClassSelect", function () {
                    const selectedClass = $(this).val();
                    loadSubClassesModule(selectedClass, "deleteSubclassSelect");
                });

            } else if (deleteType === "term") {
                // –£–¥–∞–ª–µ–Ω–∏–µ —Ç–µ—Ä–º–∏–Ω–∞
                $('#relationModalLabel').text("–£–¥–∞–ª–∏—Ç—å –¢–µ—Ä–º–∏–Ω");
                $('#relationModal .modal-body').append(`
                    <h6>–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å</h6>
                    <select id="deleteClassSelect" class="form-select mb-2"></select>
                    <h6>–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥–∫–ª–∞—Å—Å</h6>
                    <select id="deleteSubclassSelect" class="form-select mb-2"></select>
                    <h6>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ—Ä–º–∏–Ω</h6>
                    <select id="deleteTermSelect" class="form-select mb-2"></select>
                `);

                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–ª–∞—Å—Å—ã
                loadClassesModule("deleteClassSelect");

                // –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–ª–∞—Å—Å–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–¥–∫–ª–∞—Å—Å—ã
                $(document).on("change", "#deleteClassSelect", function () {
                    const selectedClass = $(this).val();
                    loadSubClassesModule(selectedClass, "deleteSubclassSelect");
                });

                // –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–¥–∫–ª–∞—Å—Å–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ—Ä–º–∏–Ω—ã
                $(document).on("change", "#deleteSubclassSelect", function () {
                    const selectedSubclass = $(this).val();
                    loadTermsModule(selectedSubclass, "deleteTermSelect");
                });
            } else if (deleteType === "clear-all") {
                // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
                $('#relationModalLabel').text("–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ");
                $('#relationModal .modal-body').html("<p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ?</p>");
            }

            // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É "–£–¥–∞–ª–∏—Ç—å" –≤ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            $('#relationModal .modal-footer').html(`
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button type="button" class="btn btn-danger" id="confirmDeleteBtn">–£–¥–∞–ª–∏—Ç—å</button>
            `);

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è
            $(document).on("click", "#confirmDeleteBtn", function () {
                if (deleteType === "class") {
                    const selectedClass = $("#deleteClassSelect").val();
                    if (selectedClass) {
                        deleteNode("class", selectedClass);
                    }
                } else if (deleteType === "subclass") {
                    const selectedClass = $("#deleteClassSelect").val();
                    const selectedSubclass = $("#deleteSubclassSelect").val();
                    if (selectedClass && selectedSubclass) {
                        deleteNode("subclass", selectedSubclass);
                    }
                } else if (deleteType === "term") {
                    const selectedClass = $("#deleteClassSelect").val();
                    const selectedSubclass = $("#deleteSubclassSelect").val();
                    const selectedTerm = $("#deleteTermSelect").val();
                    if (selectedClass && selectedSubclass && selectedTerm) {
                        deleteNode("term", selectedTerm);
                    }
                } else if (deleteType === "clear-all") {
                    deleteAllData();
                }
            });
        });


        $(document).on("click", ".add-option", function (event) {
            event.preventDefault();

            const addType = $(this).data("add-type");
            $('#relationModal').modal('show');
            $('#relationModal .modal-body').html('');
            $('#relationModal .modal-footer').html('');

            if (addType === "class") {
                $('#relationModalLabel').text("–î–æ–±–∞–≤–∏—Ç—å –ö–ª–∞—Å—Å");
                $('#relationModal .modal-body').append(`
                    <span style="font-size: 12px;">(–∑–∞–ø–æ–ª–Ω—è—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º)</span> <span style="color: red;">*</span>
                    <input type="text" id="className" class="form-control mb-2" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∫–ª–∞—Å—Å–∞">
                `);
                $('#relationModal .modal-footer').html(`
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
                    <button id="addClassBtn" class="btn btn-success" data-type="–ö–ª–∞—Å—Å">–î–æ–±–∞–≤–∏—Ç—å</button>
                `);
            } else if (addType === "subclass") {
                $('#relationModalLabel').text("–î–æ–±–∞–≤–∏—Ç—å –ü–æ–¥–∫–ª–∞—Å—Å");
                $('#relationModal .modal-body').append(`
                    <span style="font-size: 12px;">(–∑–∞–ø–æ–ª–Ω—è—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º)</span> <span style="color: red;">*</span>
                    <select id="parentClassSelect" class="form-control mb-2">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–ª–∞—Å—Å</option>
                    </select>
                    <input type="text" id="subclassName" class="form-control mb-2" placeholder="–ü–æ–¥–∫–ª–∞—Å—Å">
                `);
                $('#relationModal .modal-footer').html(`
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
                    <button id="addSubclassBtn" class="btn btn-success" data-type="–ü–æ–¥–∫–ª–∞—Å—Å">–î–æ–±–∞–≤–∏—Ç—å</button>
                `);
                loadClassesModule("parentClassSelect");
            } else if (addType === "term") {
                $('#relationModalLabel').text("–î–æ–±–∞–≤–∏—Ç—å –¢–µ—Ä–º–∏–Ω");
                $('#relationModal .modal-body').append(`
                    <span style="font-size: 12px;">(–∑–∞–ø–æ–ª–Ω—è—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º)</span> <span style="color: red;">*</span>
                    <select id="subclassSelect" class="form-control mb-2">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥–∫–ª–∞—Å—Å</option>
                    </select>
                    <input type="text" id="termName" class="form-control mb-2" placeholder="–¢–µ—Ä–º–∏–Ω">
                `);
                $('#relationModal .modal-footer').html(`
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
                    <button id="addTermBtn" class="btn btn-success" data-type="–¢–µ—Ä–º–∏–Ω">–î–æ–±–∞–≤–∏—Ç—å</button>
                `);
                 // –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –ø–æ–¥–∫–ª–∞—Å—Å—ã –¥–ª—è –≤—ã–±–æ—Ä–∞
                fetch(`https://thesaurus-api-ntx3.onrender.com/get_subclasses`)
                    .then(response => response.json())
                    .then(data => {
                        const select = document.getElementById("subclassSelect");
                        select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥–∫–ª–∞—Å—Å</option>';
                        data.subclasses.forEach(subclassName => {
                            let option = document.createElement("option");
                            option.value = subclassName;
                            option.textContent = subclassName;
                            select.appendChild(option);
                        });
                    })
                    .catch(error => console.log("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–¥–∫–ª–∞—Å—Å–æ–≤:", error));
                }
            });


        // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –¥–ª—è —è–∑—ã–∫–æ–≤
        $(document).on("click", "#addClassBtn, #addSubclassBtn, #addTermBtn", function () {
            
            const type = $(this).data("type");
            console.log("–í—ã–±—Ä–∞–Ω —Ç–∏–ø:", type);
            let inputValue = "";
            let parentValue = "";
            
            if (type == "–ö–ª–∞—Å—Å") {
                inputValue = $("#className").val().trim();
            } else if (type == "–ü–æ–¥–∫–ª–∞—Å—Å") {
                inputValue = $("#subclassName").val().trim();
                parentValue = $("#parentClassSelect").val();
            } else if (type == "–¢–µ—Ä–º–∏–Ω") {
                inputValue = $("#termName").val().trim();
                parentValue = $("#subclassSelect").val();
            }

            console.log("–í–≤–µ–¥–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:", inputValue); 
            console.log("–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:", parentValue);

            if (!inputValue) {
                alert(`–í–≤–µ–¥–∏—Ç–µ –∏–º—è –¥–ª—è ${type.toLowerCase()}!`);
                return;
            }

            if ((type === "–ü–æ–¥–∫–ª–∞—Å—Å" || type === "–¢–µ—Ä–º–∏–Ω") && !parentValue) {
                alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–ª–∞—Å—Å/–ø–æ–¥–∫–ª–∞—Å—Å!");
                return;
            }


            $("#saveModalBtn").data("type", type); // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–∏–ø –≤ –∫–Ω–æ–ø–∫–µ
            $("#saveModalBtn").data("parent", parentValue);
                    
            $('#confirmationModal').modal('show');
            $('#relationModal').modal('hide'); // –°–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—ès

            const labelText = {
                "–ö–ª–∞—Å—Å": { ru: "–ó–∞–ø–æ–ª–Ω–µ–Ω –∫–ª–∞—Å—Å –Ω–∞ —Ä—É—Å—Å–∫–æ–º:", kz: "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∫–ª–∞—Å—Å –Ω–∞ –∫–∞–∑–∞—Ö—Å–∫–æ–º:", en: "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∫–ª–∞—Å—Å –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º:" },
                "–ü–æ–¥–∫–ª–∞—Å—Å": { ru: "–ó–∞–ø–æ–ª–Ω–µ–Ω –ø–æ–¥–∫–ª–∞—Å—Å –Ω–∞ —Ä—É—Å—Å–∫–æ–º:", kz: "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–¥–∫–ª–∞—Å—Å –Ω–∞ –∫–∞–∑–∞—Ö—Å–∫–æ–º:", en: "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–¥–∫–ª–∞—Å—Å –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º:" },
                "–¢–µ—Ä–º–∏–Ω": { ru: "–ó–∞–ø–æ–ª–Ω–µ–Ω —Ç–µ—Ä–º–∏–Ω –Ω–∞ —Ä—É—Å—Å–∫–æ–º:", kz: "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Ä–º–∏–Ω –Ω–∞ –∫–∞–∑–∞—Ö—Å–∫–æ–º:", en: "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Ä–º–∏–Ω –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º:" }
            };
            $("#modalLabel").text(`–î–æ–±–∞–≤–∏—Ç—å ${type}`);
            $("#modalLabelRu").text(labelText[type].ru);
            $("#modalLabelKz").text(labelText[type].kz);
            $("#modalLabelEn").text(labelText[type].en);
            $("#modalInputRu").val(inputValue);
            $("#modalInputKz").val("");
            $("#modalInputEn").val("");
            $("#saveModalBtn").data("type", type);  

            // $("relationModal").modal("hide"); // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        });   


        $(document).on("click", "#saveUfSynonymBtn", function () {
            let ufType = $(this).data("uf-type"); // "UF-1" –∏–ª–∏ "UF-2"
            if (ufType === "UF-1"){
                ufType = "UF_1";
            } else if (ufType === "UF-2"){
                ufType = "UF_2";
            }
            console.log("–í—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∏–ø UF:", ufType);
            const term = $("#ufTermSelect").val();
            const synonym_ru = $("#ufSynonymRu").val().trim();
            const synonym_kz = $("#ufSynonymKz").val().trim();
            const synonym_en = $("#ufSynonymEn").val().trim();

            if (!term) {
                alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ—Ä–º–∏–Ω!");
                return;
            }
            if (!synonym_ru) {
                alert("–í–≤–µ–¥–∏—Ç–µ —Å–∏–Ω–æ–Ω–∏–º –Ω–∞ —Ä—É—Å—Å–∫–æ–º!");
                return;
            }

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            fetch("https://thesaurus-api-ntx3.onrender.com/add_synonym", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    term: term,
                    synonym_ru: synonym_ru,
                    synonym_kz: synonym_kz,
                    synonym_en: synonym_en,
                    uf_type: ufType
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    $('#relationModal').modal('hide');
                    loadGraph();
                } else {
                    alert("–û—à–∏–±–∫–∞: " + (data.detail || "–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å —Å–∏–Ω–æ–Ω–∏–º"));
                }
            })
            .catch(error => {
                alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Å–∏–Ω–æ–Ω–∏–º–∞: " + error);
                console.log("–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Å–∏–Ω–æ–Ω–∏–º–∞:", error);
            });
        });


        // –æ—á–∏—â–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏
        $('#relationModal').on('hidden.bs.modal', function () {
            // –û—á–∏—â–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏
            $('#relationModal .modal-body').html("");
            $('#relationModal .modal-footer').html("");
            $('#relationModalLabel').text("");
            $(document).off("click", "#confirmDeleteBtn"); // –£–¥–∞–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è
        });

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —É–∑–ª–∞
        function deleteNode(type, name) {
            fetch(`https://thesaurus-api-ntx3.onrender.com/delete_node`, {
                method: "DELETE",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ type: type, name: name }),
            })
            .then(response => response.json())
            .then(data => {
                if (data.message) {
                    console.log(`${type} "${name}" —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω.`);
                    $('#relationModal').modal('hide');
                    loadClassesAndSubClasses(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–∫–∏
                    loadGraph(); // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ
                } else {
                    alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏: " + data.error);
                }
            })
            .catch(error => console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏:", error));
        }

        function deleteAllData() {
             fetch("https://thesaurus-api-ntx3.onrender.com/delete_all_data", { method: "DELETE" })
                .then(response => response.json())
                .then(data => {
                    if (data.message) {
                        console.log("–í—Å–µ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã!");
                        $('#relationModal').modal('hide');
                        loadClassesAndSubClasses(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–∫–∏
                        loadGraph(); // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ
                    } else {
                        alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö: " + data.error);
                    }
                })
                .catch(error => console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö:", error));
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        function createRelationBetweenTerms(term1, term2, relationType) {
            console.log("–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä:", {
                term1: term1,
                term2: term2,
                relationType: relationType // –ü–æ—Å–º–æ—Ç—Ä–∏–º, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è
            });

            fetch("https://thesaurus-api-ntx3.onrender.com/create_relation_between_terms", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    term1: term1,
                    term2: term2,
                    relationType: relationType
                }),
            })
            .then(response => response.json())
            .then(data => { 
                console.log("–û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:", data);
                if (data.message === "–°–≤—è–∑—å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞") {
                // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
                    $('#relationModal').modal('hide');
                    loadGraph();
                } else {
                    console.log("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: " + (data.error || "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"));
                }
            })
            .catch(error => console.error("–û—à–∏–±–∫–∞:", error));
        }   

        // –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤
        function loadClassesModule(selectElementId) {
            fetch("https://thesaurus-api-ntx3.onrender.com/classes")
                .then(response => response.json())
                .then(data => {
                    console.log("–ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã:", data);
                    const select = document.getElementById(selectElementId);
                    select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å</option>';
                    data.classes.forEach(className => {
                        let option = document.createElement("option");
                        option.value = className;
                        option.textContent = className;
                        select.appendChild(option);
                    });
                })
                .catch(error => console.log("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–ª–∞—Å—Å–æ–≤:", error));
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–¥–∫–ª–∞—Å—Å–æ–≤
        function loadSubClassesModule(className, selectElementId) {
            if (!className) return;

            fetch(`https://thesaurus-api-ntx3.onrender.com/subclasses/${className}`)
                .then(response => response.json())
                .then(data => {
                    console.log("–ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –ø–æ–¥–∫–ª–∞—Å—Å—ã:", data);
                    const select = document.getElementById(selectElementId);
                    select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥–∫–ª–∞—Å—Å</option>';
                    data.subclasses.forEach(subclassName => {
                        let option = document.createElement("option");
                        option.value = subclassName;
                        option.textContent = subclassName;
                        select.appendChild(option);
                    });
                })
                .catch(error => console.log("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–¥–∫–ª–∞—Å—Å–æ–≤:", error));
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Ä–º–∏–Ω–æ–≤
        function loadTermsModule(subclassName, selectElementId) {
            if (!subclassName) return;

            fetch(`https://thesaurus-api-ntx3.onrender.com/terms/${subclassName}`)
                .then(response => response.json())
                .then(data => {
                    console.log("–ü–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã:", data);
                    const select = document.getElementById(selectElementId);
                    select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ—Ä–º–∏–Ω</option>';
                    data.terms.forEach(termName => {
                        let option = document.createElement("option");
                        option.value = termName;
                        option.textContent = termName;
                        select.appendChild(option);
                    });
                })
                .catch(error => console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ—Ä–º–∏–Ω–æ–≤:", error));
        }

        $(document).ready(function () {
            loadClassesAndSubClasses();
        });

        // –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤, –ø–æ–¥–∫–ª–∞—Å—Å–æ–≤ –∏ —Ç–µ—Ä–º–∏–Ω–æ–≤ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–∞—Ö
        $(document).ready(function () {
            function openModal(type, inputValue) {
                let labelText = {
                    "–ö–ª–∞—Å—Å": { ru: "–ó–∞–ø–æ–ª–Ω–µ–Ω –∫–ª–∞—Å—Å –Ω–∞ —Ä—É—Å—Å–∫–æ–º:", kz: "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∫–ª–∞—Å—Å –Ω–∞ –∫–∞–∑–∞—Ö—Å–∫–æ–º:", en: "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∫–ª–∞—Å—Å –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º:" },
                    "–ü–æ–¥–∫–ª–∞—Å—Å": { ru: "–ó–∞–ø–æ–ª–Ω–µ–Ω –ø–æ–¥–∫–ª–∞—Å—Å –Ω–∞ —Ä—É—Å—Å–∫–æ–º:", kz: "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–¥–∫–ª–∞—Å—Å –Ω–∞ –∫–∞–∑–∞—Ö—Å–∫–æ–º:", en: "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–¥–∫–ª–∞—Å—Å –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º:" },
                    "–¢–µ—Ä–º–∏–Ω": { ru: "–ó–∞–ø–æ–ª–Ω–µ–Ω —Ç–µ—Ä–º–∏–Ω –Ω–∞ —Ä—É—Å—Å–∫–æ–º:", kz: "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Ä–º–∏–Ω –Ω–∞ –∫–∞–∑–∞—Ö—Å–∫–æ–º:", en: "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Ä–º–∏–Ω –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º:" }
                };

                $("#modalLabel").text("–î–æ–±–∞–≤–∏—Ç—å " + type);
                $("#modalLabelRu").text(labelText[type].ru);
                $("#modalLabelKz").text(labelText[type].kz);
                $("#modalLabelEn").text(labelText[type].en);
                $("#modalInputRu").val(inputValue);
                $("#modalInputKz").val("");
                $("#modalInputEn").val("");

                $("#saveModalBtn").data("type", type);  
            }

            $("#addClassBtn").click(function () {
                let className = $("#className").val().trim();
                if (className) openModal("–ö–ª–∞—Å—Å", className);
            });

            $("#addSubclassBtn").click(function () {
                let subclassName = $("#subclassName").val().trim();
                if (subclassName) openModal("–ü–æ–¥–∫–ª–∞—Å—Å", subclassName);
            });

            $("#addTermBtn").click(function () {
                let termName = $("#termName").val().trim();
                if (termName) openModal("–¢–µ—Ä–º–∏–Ω", termName);
            });



            $("#saveModalBtn").click(function () {
                let type = $(this).data("type");
                console.log("–í—ã–±—Ä–∞–Ω—ã–π —Ç–∏–ø" + type)
                let parent = $(this).data("parent") || null;
                let ru = $("#modalInputRu").val().trim();
                let kz = $("#modalInputKz").val().trim();
                let en = $("#modalInputEn").val().trim();

                if (!ru) {
                    console.log("–û—Å–Ω–æ–≤–Ω–æ–µ –ø–æ–ª–µ (—Ä—É—Å—Å–∫–∏–π) –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º!");
                    return;
                }

                let requestData = {
                    type: type,
                    ru: ru,
                    kz: kz,
                    en: en,
                    parent: parent  // –î–æ–±–∞–≤–ª—è–µ–º —Ä–æ–¥–∏—Ç–µ–ª—è
                };

                fetch("https://thesaurus-api-ntx3.onrender.com/add_node/", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(requestData)
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        // alert("–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã!");
                        loadGraph();

                                
                        // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª–µ–π –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
                        $("#className").val("");
                        $("#subclassName").val("");
                        $("#termName").val("");
                        $("#confirmationModal").modal("hide");

                            
                        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—ã–ø–∞–¥–∞—é—â–∏—Ö —Å–ø–∏—Å–∫–æ–≤
                        loadClassesAndSubClasses();
                    } else {
                        alert("–û—à–∏–±–∫–∞: " + data.detail);
                    }
                }).catch(error => console.log("–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —É–∑–ª–∞:", error));
            });
        });

        // –∫–Ω–æ–ø–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
        $("#checkServerBtn").click(function() {
            const statusElement = document.getElementById("serverStatus");
            const loadingIndicator = document.getElementById("loadingIndicator");

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –ø–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–æ–º
            loadingIndicator.style.display = "block";
            statusElement.innerHTML = "";

            fetch("https://thesaurus-api-ntx3.onrender.com/")
                .then(response => response.json())
                .then(data => {
                    setTimeout(() => {
                        statusElement.innerHTML = "<span class='text-success'>–°–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç!</span>";
                        setTimeout(() => {
                            document.getElementById("checkServerSection").style.display = "none";
                            document.getElementById("neo4jSection").style.display = "block";
                            loadGraph();  // –ó–∞–≥—Ä—É–∂–∞–µ–º –≥—Ä–∞—Ñ
                        }, 1000);
                    }, 500);
                })
                .catch(error => {
                    setTimeout(() => {
                        statusElement.innerHTML = "<span class='text-danger'>–û—à–∏–±–∫–∞: —Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç!</span>";
                    }, 500);
                })
                .finally(() => {
                    setTimeout(() => {
                        loadingIndicator.style.display = "none"; // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ—Å–ª–µ –∑–∞–¥–µ—Ä–∂–∫–∏
                    }, 1000);
                });
        });

        function loadClassesAndSubClasses() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–ª–∞—Å—Å—ã
            fetch(`https://thesaurus-api-ntx3.onrender.com/get_classes`)
                .then(response => response.json())
                .then(data => {
                    const classSelect = document.getElementById("parentClassSelect");
                    classSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–ª–∞—Å—Å</option>';
                    data.classes.forEach(className => {
                        let option = document.createElement("option");
                        option.value = className;
                        option.textContent = className;
                        classSelect.appendChild(option);
                    });
                    console.log("–ö–ª–∞—Å—Å—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã.");
                })
                .catch(error => console.log("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–ª–∞—Å—Å–æ–≤:", error));

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–¥–∫–ª–∞—Å—Å—ã
            fetch(`https://thesaurus-api-ntx3.onrender.com/get_subclasses`)
                .then(response => response.json())
                .then(data => {
                    const subclassSelect = document.getElementById("subclassSelect");
                    subclassSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥–∫–ª–∞—Å—Å</option>';
                    data.subclasses.forEach(subclassName => {
                        let option = document.createElement("option");
                        option.value = subclassName;
                        option.textContent = subclassName;
                        subclassSelect.appendChild(option);
                    });
                    console.log("–ü–æ–¥–∫–ª–∞—Å—Å—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã.");
                })
                .catch(error => console.log("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–¥–∫–ª–∞—Å—Å–æ–≤:", error));
        }

        // –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–¥ –ø—Ä–∏ –Ω–∞–∂–∞–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É
        $("#loadDataBtn").click(function() {
            loadGraph();
        });

        // –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
        function loadGraph() {
            fetch("https://thesaurus-api-ntx3.onrender.com/graph_data")
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        document.getElementById("visualization").innerHTML = "<span class='text-danger'>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥—Ä–∞—Ñ–∞: " + data.error + "</span>";
                        return;
                    }

                    // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
                    document.getElementById("visualization").innerHTML = "";
                    var container = document.getElementById("visualization");

                    // var nodes = new vis.DataSet(data.nodes);
                    var nodes = new vis.DataSet(
                        data.nodes.map(node => {
                            console.log("–¢–∏–ø —É–∑–ª–∞:", node.group, "–ò–º—è:", node.label); // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å

                            let nodeType = (node.group || "").toLowerCase(); // –ë–µ—Ä–µ–º group –≤–º–µ—Å—Ç–æ type
                            let color = "#999999";  // –°–µ—Ä—ã–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                            let size = 30; // –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä

                            if (nodeType === "class") {
                                color = "#007bff"; // –°–∏–Ω–∏–π –¥–ª—è –∫–ª–∞—Å—Å–æ–≤
                            } else if (nodeType === "subclass") {
                                color = "#28a745"; // –ó–µ–ª—ë–Ω—ã–π –¥–ª—è –ø–æ–¥–∫–ª–∞—Å—Å–æ–≤
                            } else if (nodeType === "term") {
                                color = "#ffc107"; // –ñ—ë–ª—Ç—ã–π –¥–ª—è —Ç–µ—Ä–º–∏–Ω–æ–≤
                            } else if (nodeType === "translate") {
                                color = "#a020f0"; // –§–∏–æ–ª–µ—Ç–æ–≤—ã–π –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥ —Ç–µ—Ä–º–∏–Ω–æ–≤
                            } 

                            return {
                                id: node.id,
                                label: node.label,
                                color: { background: color, border: "#000000" },
                                font: { color: "black", size: 16 },
                                scaling: { min: 10, max: 100 }
                            };
                        })
                    );
                    var edges = new vis.DataSet(data.edges);

                    var graphData = { nodes: nodes, edges: edges };

                    var options = {
                        edges: {
                            arrows: "to",
                            color: "#848484",
                            smooth: true
                        },
                        physics: {
                            enabled: true
                        }
                    };

                    new vis.Network(container, graphData, options);
                })
                .catch(error => {
                    document.getElementById("visualization").innerHTML = "<span class='text-danger'>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥—Ä–∞—Ñ–∞</span>";
                    console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥—Ä–∞—Ñ–∞:", error);
                });
        }


    </script>
</body>
</html>
